<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html> <head>
<title>How far along?</title>
 <link rel="stylesheet" href="https://unpkg.com/leaflet@1.2.0/dist/leaflet.css"
   integrity="sha512-M2wvCLH6DSRazYeZRIm1JnYyh22purTM+FDB5CsyxtQJYeKq83arPe5wgbNmcFXGqiSH2XR8dT/fJISVA1r/zQ=="
crossorigin=""/>
<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<style>
body {
    padding: 0;
    margin: 0;
}
html, body, #map {
    height: 100%;
}
.rider-icon { background-color: #00cc00;
               color: #ff0000;
               width: auto; }
         }
</style>
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
</head>

<body>

<div id="map" style="height: 100%;"></div>
<div id="log"></div>

<script src="static/js/dist/enroute.js"></script>

<script>



var options = {
    center:  [44.709248,-122.8550084],
    zoom: 8,
    spot_feeds: [ ],
    routes:  [{ points: "DariDart.json",
               distances: "DariDartUTM.json",
               color:  "#196666",
               name: "Dari Dart" }   ],
    utm_file: "DariDartUTM.json"
}; 
var tracking = new Enroute(options);

/*  Experimental code that will be replaced by code
 *  in Enroute that associates each tracked spot / checkin
 *  with a UTM track and a start time to calculate
 *  distance along track and time in hand.
 */ 

/* 

map = tracking.map;
console.log("Map object: " + map);


function pop_progress(latlon, distance) {
   console.log("In pop_progress");
   var content = "<p>Off route</p>"; 
   if (distance > 0) {
       distance = Math.round(distance);
       // True when we were able to find distance
       content = "<p>About " + distance + "km along route</p>";
   }
   var popup = L.popup()
   .setLatLng(latlon)
   .setContent(content)
   .openOn(map);
}

map.on("click", function (mouse_event) {
   console.log("Got click event; mouse event " + mouse_event)
   var pos = mouse_event.latlng;
   console.log("pos is " + pos)
   var lat = pos.lat;
   var lng = pos.lng;
   console.log("Lat & Lon: " + lat + ", " + lng);
   var along_track = "DariDartUTM.json";
   $.getJSON("/_along", { lat: lat, lng: lng, track: along_track },
       function (data) {
       	   console.log("Got JSON response from _along");
	   console.log("Response data: " + data.result); 
           pop_progress(pos, data.result); }
       );
   });
*/ 
</script>

</body> </html>
